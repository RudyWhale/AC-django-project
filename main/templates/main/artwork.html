{% extends "main/wrapper.html" %}

{% block styles %}
	{% load static %}

	<link href="{% static 'main/styles/artist overview.css' %}" type="text/css" rel="stylesheet" />
	<link href="{% static 'main/styles/artwork.css' %}" type="text/css" rel="stylesheet" />
	<link href="{% static 'main/styles/publication.css' %}" type="text/css" rel="stylesheet" />
	<link href="{% static 'main/styles/strip gallery.css' %}" type="text/css" rel="stylesheet" />
	<link href="{% static 'main/styles/content.css' %}" type="text/css" rel="stylesheet" />
{% endblock %}

{% block scripts %}
	{% load static %}

	<script src="{% static 'main/scripts/comment_effects.js' %}" type="text/javascript"></script>
	<script src="{% static 'main/scripts/textarea_limited_length.js' %}" type="text/javascript"></script>
	<script src="{% static 'useractions/like_comment_subscribe_btn.js' %}" type="text/javascript"></script>
	<script src="{% static 'useractions/publication_delete.js' %}" type="text/javascript"></script>
{% endblock %}

{% block content %}

{% include "main/page_blocks/header.html" %}
{% include "main/page_blocks/menu.html" %}

<div class="bounded_wrapper">

	<div class="artwork_repr">

		<div class="artwork_img">
			<p class="image_loading_label">Загружаю картинку, подождите...</p>
			<img class="center" src="{{artwork.image.url}}" alt="{{artwork.name}}" onload="on_artwork_load(this)" />
		</div>

		<div class="artwork_desc">

			<div class="artwork_desc_text">

				<h3>{{artwork.name}}</h3>
				<p class="artwork_date">{{artwork.datetime}}
					{% if user == artwork.author.user %}
						<button href="{% url 'delete publication' pk=artwork.pk %}" class="publication_delete hover_accent_dark">Удалить</button>
					{% endif %}
				</p>
				<p class="artwork_desc_text">{{artwork.desc}}</p>

				<div class="tags">
					{% for tag in artwork.tag_set.all %}
						<a class="tag hover_accent_dark" href="{% url 'tag' pk=tag.pk %}">#{{tag.name}}</a>
					{% empty %}
						<p class="no_tags_label">Теги не указаны</p>
					{% endfor %}
				</div>

				<div class="comments">
					<h5 class="comments_header">Комментарии:</h5>
					<div class="comment_form">
						<textarea rows="2" cols="20" class="limited_length" placeholder="Напишите комментарий" maxlength="{{max_comment_length}}"></textarea>
						<button class="transparent_btn" data-pk="{{artwork.pk}}" data-username="{{request.user.username}}"
						{% if user.is_authenticated %}
							onclick="comment_send($(this));"
						{% else %}
							onclick="not_auth_alert();"
						{% endif %}>
						{% load static %}
						<img src="{% static 'icons/send.png' %}">
						</button>
						<p class="symbols_left_label hide">осталось символов: {{max_comment_length}}</p>
					</div>

					{% for comment in artwork.comment_set.all %}
						{% include "main/includes/artwork comment.html" %}
					{% endfor %}
				</div>

			</div><!-- desc_text -->

			<div class="publication_likes">
			  <p class="publication_likes_count">{{artwork.likes.count}}</p>
			  {% load main_tags %}
			  <button class="publication_likes_btn hover_accent" data-pk="{{artwork.pk}}"
			  {% if user.is_authenticated %}
			    onclick="like_send($(this));"
			  {% else %}
			    onclick="not_auth_alert();"
			  {% endif %}>{{artwork|like_btn_text:user}}</button>
			</div><!-- publication_likes -->

		</div><!-- artwork_desc -->

	</div><!-- painting_repr -->

</div><!-- bounded_wrapper -->

{% include "main/page_blocks/strip gallery.html" with publications=related_pubs %}
{% include "main/page_blocks/artist overview.html" with profile=artwork.author user=request.user %}
{% include "main/page_blocks/footer.html" %}

{% endblock %}
